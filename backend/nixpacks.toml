[phases.setup]
nixPkgs = ["nodejs-18_x", "openssl"]

[phases.install]
cmds = ["npm ci"]

[phases.build]
cmds = ["npx prisma generate", "npm run build"]

[start]
cmd = "echo 'Starting application...' && ls -la dist/ && echo 'DATABASE_URL set:' && [ -n \"$DATABASE_URL\" ] && echo 'Yes' || echo 'No' && npx prisma migrate deploy && node dist/index.js"
